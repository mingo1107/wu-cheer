import{a as B,b as M,r as y,o as T,c as o,d as e,k as A,w as D,p as _,s as U,v as C,F as h,g as L,e as c,f as g,t as i,j as $,l as N,h as l,i as E}from"./app-86615f25.js";import{u as F}from"./usePagination-22cbe88a.js";class I{async getLogs(w={}){return B.get("/user-logs",w)}}const H=new I,S={class:"container mx-auto px-4 py-8"},O={class:"max-w-7xl mx-auto"},W={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white/20"},q={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8"},G={class:"flex","aria-label":"Breadcrumb"},J={class:"inline-flex items-center space-x-1 md:space-x-3"},K={class:"inline-flex items-center"},Q={class:"mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"},R={class:"bg-white rounded-xl shadow-lg overflow-hidden"},X={key:0,class:"p-8 text-center"},Y={key:1,class:"p-8 text-center"},Z={key:2,class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200"},te={class:"bg-white divide-y divide-gray-200"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ae={class:"px-6 py-4 whitespace-nowrap"},re={class:"text-sm font-medium text-gray-900"},oe={class:"text-sm text-gray-500"},le={class:"px-6 py-4 whitespace-nowrap"},ne={class:"text-sm text-gray-900"},ie={class:"text-sm text-gray-500"},de={class:"px-6 py-4 whitespace-nowrap"},ue={key:0,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"},ce={key:1,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xe={class:"px-6 py-4 text-sm text-gray-900 max-w-md"},pe=["title"],ge={key:3,class:"bg-gray-50 px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},fe={class:"flex-1 flex justify-between sm:hidden"},ye=["disabled"],be=["disabled"],ve={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},_e={class:"text-sm text-gray-700"},he={class:"font-medium"},we={class:"font-medium"},ke={class:"font-medium"},Ce={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Le=["disabled"],ze=["onClick"],Ve={key:1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700"},Pe=["disabled"],Me={__name:"UserLog",setup(z){const{success:w,error:k}=M(),b=y(!1),m=y([]),a=y(null),d=y({result:"",date_from:"",date_to:""}),u=async(p=1)=>{var t,f,s;b.value=!0;try{const r={page:p,per_page:15,...d.value};Object.keys(r).forEach(v=>{(r[v]===""||r[v]===null)&&delete r[v]});const n=await H.getLogs(r);n.status?(m.value=Array.isArray((t=n.data)==null?void 0:t.data)?n.data.data:[],a.value={current_page:n.data.current_page||1,last_page:n.data.last_page||1,from:n.data.from||0,to:n.data.to||0,total:n.data.total||0}):(k(n.message||"載入操作記錄失敗"),m.value=[],a.value=null)}catch(r){console.error("載入操作記錄失敗:",r),k("載入操作記錄失敗："+(((s=(f=r.response)==null?void 0:f.data)==null?void 0:s.message)||r.message||"未知錯誤")),m.value=[],a.value=null}finally{b.value=!1}},V=()=>{d.value={result:"",date_from:"",date_to:""},u(1)},{visiblePages:P,goToPage:x}=F(a,u),j=p=>p?new Date(p).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return T(()=>{u()}),(p,t)=>{const f=N("router-link");return l(),o("div",S,[e("div",O,[e("div",W,[e("div",q,[e("div",null,[t[9]||(t[9]=e("h2",{class:"text-2xl font-bold text-gray-800 mb-2"},"使用者操作紀錄",-1)),e("nav",G,[e("ol",J,[e("li",K,[A(f,{to:"/dashboard",class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-amber-600 transition-colors duration-200"},{default:D(()=>[...t[7]||(t[7]=[e("i",{class:"fas fa-home mr-2"},null,-1),g(" Dashboard ",-1)])]),_:1})]),t[8]||(t[8]=e("li",null,[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-chevron-right text-gray-400 mr-2"}),e("span",{class:"text-sm font-medium text-gray-500"},"使用者操作紀錄")])],-1))])])])]),e("div",Q,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"結果",-1)),_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.value.result=s),onChange:u,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"},[...t[10]||(t[10]=[e("option",{value:""},"全部",-1),e("option",{value:"1"},"成功",-1),e("option",{value:"0"},"失敗",-1)])],544),[[U,d.value.result]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"開始日期",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>d.value.date_from=s),type:"date",onChange:u,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"},null,544),[[C,d.value.date_from]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"結束日期",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value.date_to=s),type:"date",onChange:u,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"},null,544),[[C,d.value.date_to]])]),e("div",{class:"flex items-end"},[e("button",{onClick:V,class:"w-full bg-gray-500 text-white py-2 px-4 rounded-xl font-semibold hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200"}," 重置篩選 ")])]),e("div",R,[b.value?(l(),o("div",X,[...t[14]||(t[14]=[e("svg",{class:"animate-spin h-8 w-8 text-amber-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("p",{class:"text-gray-600"},"載入中...",-1)])])):m.value.length===0?(l(),o("div",Y,[...t[15]||(t[15]=[e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1),e("p",{class:"text-gray-600 text-lg"},"沒有找到操作記錄",-1)])])):(l(),o("div",Z,[e("table",ee,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"時間"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"使用者"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"控制器/方法"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"結果"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"IP"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"備註")])],-1)),e("tbody",te,[(l(!0),o(h,null,L(m.value,s=>{var r,n;return l(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",se,i(j(s.created_at)),1),e("td",ae,[e("div",re,i(((r=s.user)==null?void 0:r.name)||"未知使用者"),1),e("div",oe,i(((n=s.user)==null?void 0:n.email)||""),1)]),e("td",le,[e("div",ne,i(s.controller||"-"),1),e("div",ie,i(s.method||"-"),1)]),e("td",de,[s.result===1?(l(),o("span",ue," 成功 ")):(l(),o("span",ce," 失敗 "))]),e("td",me,i(s.ip||"-"),1),e("td",xe,[e("div",{class:"truncate",title:s.remark},i(s.remark||"-"),9,pe)])])}),128))])])])),a.value&&a.value.total>0?(l(),o("div",ge,[e("div",fe,[e("button",{onClick:t[3]||(t[3]=s=>c(x)(a.value.current_page-1)),disabled:a.value.current_page===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 上一頁 ",8,ye),e("button",{onClick:t[4]||(t[4]=s=>c(x)(a.value.current_page+1)),disabled:a.value.current_page===a.value.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 下一頁 ",8,be)]),e("div",ve,[e("div",null,[e("p",_e,[t[17]||(t[17]=g(" 顯示第 ",-1)),e("span",he,i(a.value.from||0),1),t[18]||(t[18]=g(" 到 ",-1)),e("span",we,i(a.value.to||0),1),t[19]||(t[19]=g(" 筆，共 ",-1)),e("span",ke,i(a.value.total||0),1),t[20]||(t[20]=g(" 筆記錄 ",-1))])]),e("div",null,[e("nav",Ce,[e("button",{onClick:t[5]||(t[5]=s=>c(x)(a.value.current_page-1)),disabled:a.value.current_page===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[21]||(t[21]=[e("i",{class:"fas fa-chevron-left"},null,-1)])],8,Le),(l(!0),o(h,null,L(c(P),s=>(l(),o(h,{key:s},[s!=="..."?(l(),o("button",{key:0,onClick:r=>c(x)(s),class:E([s===a.value.current_page?"z-10 bg-amber-50 border-amber-500 text-amber-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},i(s),11,ze)):(l(),o("span",Ve,"..."))],64))),128)),e("button",{onClick:t[6]||(t[6]=s=>c(x)(a.value.current_page+1)),disabled:a.value.current_page===a.value.last_page,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[22]||(t[22]=[e("i",{class:"fas fa-chevron-right"},null,-1)])],8,Pe)])])])])):$("",!0)])])])])}}};export{Me as default};
