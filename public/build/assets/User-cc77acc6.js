import{h as F,i as u,j as I,c as a,a as e,b as $,w as P,g as f,k as g,v as b,F as D,l as Q,f as y,t as m,m as R,n as W,p as h,r as G,o as r}from"./app-6758fae4.js";const J={class:"container mx-auto px-4 py-8"},K={class:"max-w-7xl mx-auto"},O={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white/20"},X={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8"},Y={class:"flex","aria-label":"Breadcrumb"},Z={class:"inline-flex items-center space-x-1 md:space-x-3"},ee={class:"inline-flex items-center"},te={class:"mb-6"},se={class:"flex flex-col sm:flex-row gap-4"},oe={class:"flex-1"},le=["disabled"],ae={class:"bg-white rounded-xl shadow-lg overflow-hidden"},re={key:0,class:"p-8 text-center"},ne={key:1,class:"p-8 text-center"},ie={key:2,class:"overflow-x-auto"},de={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},ce={class:"td-base"},me={class:"flex items-center"},fe={class:"flex-shrink-0 h-10 w-10"},ve={class:"h-10 w-10 rounded-full bg-gradient-to-r from-amber-500 to-orange-600 flex items-center justify-center"},xe={class:"text-white font-semibold text-sm"},pe={class:"ml-4"},ge={class:"text-sm font-medium text-gray-900"},be={class:"td-base"},ye={class:"text-sm text-gray-900"},he={class:"td-base"},we={key:0,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"},_e={key:1,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800"},ke={class:"td-base text-gray-500"},Ce={class:"td-base font-medium"},Me={class:"action-buttons"},ze=["onClick","disabled"],Ue=["onClick","disabled"],Be={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ve={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},De={class:"mt-3"},Le={class:"flex items-center justify-between mb-6"},Ae={class:"text-lg font-semibold text-gray-900"},je={class:"block text-sm font-medium text-gray-700 mb-2"},Te={key:0,class:"text-sm text-gray-500"},qe=["required","placeholder"],He=["required","placeholder"],Ee={key:0,class:"p-4 bg-red-50 border-l-4 border-red-400 rounded"},Ne={class:"flex"},Se={class:"text-sm text-red-600"},Fe={class:"flex justify-end space-x-3 pt-4"},Ie=["disabled"],$e={key:0},Pe={key:1,class:"flex items-center"},Qe={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Re={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},We={class:"mt-3"},Ge={class:"text-sm text-gray-600 text-center mb-6"},Je={class:"flex justify-center space-x-3"},Ke=["disabled"],Oe={key:0},Xe={key:1,class:"flex items-center"},et={__name:"User",setup(Ye){W();const{success:C,error:w}=F(),i=u([]),_=u(!1),c=u(!1),l=u(null),M=u(""),v=u(!1),k=u(!1),d=u(!1),x=u(null);Array.isArray(i.value)||(i.value=[]);const n=u({id:null,name:"",email:"",password:"",password_confirmation:""}),z=async()=>{try{const s=await h.getUser(0);s.status&&s.data&&(n.value={id:null,...s.data,password:"",password_confirmation:""})}catch{}};let U;const L=()=>{clearTimeout(U),U=setTimeout(()=>{p()},500)},p=async()=>{_.value=!0,l.value=null;try{const s=await h.getUsers({search:M.value});s.status?(s.data.users&&s.data.users.data?i.value=s.data.users.data:Array.isArray(s.data.data)?(i.value=s.data.data,console.log("使用者列表:",i.value)):i.value=[],console.log("使用者列表:",i.value)):l.value=s.message||"載入使用者列表失敗"}catch(s){console.error("載入使用者列表錯誤:",s),l.value=s.message||"載入使用者列表失敗",i.value=[]}finally{_.value=!1}},A=async()=>{d.value=!1,await z(),l.value=null,v.value=!0},j=s=>{if(!s||!s.id){l.value="無效的使用者資料";return}d.value=!0,n.value={id:s.id,name:s.name||"",email:s.email||"",password:"",password_confirmation:""},l.value=null,v.value=!0},B=()=>{v.value=!1,l.value=null},T=async()=>{c.value=!0,l.value=null;try{let s;if(d.value){if(!n.value.id){l.value="無效的使用者 ID";return}s=await h.updateUser(n.value.id,n.value)}else s=await h.createUser(n.value);s.status?(v.value=!1,await p(),d.value?C("使用者更新成功！"):C("使用者新增成功！")):(l.value=s.message,w(s.message||"操作失敗"))}catch(s){l.value=s.message||"操作失敗",w(s.message||"操作失敗")}finally{c.value=!1}},q=s=>{if(!s||!s.id){l.value="無效的使用者資料";return}x.value=s,k.value=!0},H=async()=>{if(!x.value||!x.value.id){l.value="無效的使用者資料";return}c.value=!0,l.value=null;try{const s=await h.deleteUser(x.value.id);s.status?(k.value=!1,await p(),C("使用者刪除成功！")):(l.value=s.message,w(s.message||"刪除失敗"))}catch(s){l.value=s.message||"刪除失敗",w(s.message||"刪除失敗")}finally{c.value=!1}},E=s=>s?new Date(s).toLocaleDateString("zh-TW"):"未知";return I(()=>{z(),p()}),(s,t)=>{var V;const N=G("router-link");return r(),a(D,null,[e("div",J,[e("div",K,[e("div",O,[e("div",X,[e("div",null,[t[8]||(t[8]=e("h2",{class:"text-2xl font-bold text-gray-800 mb-2"},"使用者管理",-1)),e("nav",Y,[e("ol",Z,[e("li",ee,[$(N,{to:"/dashboard",class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-amber-600 transition-colors duration-200"},{default:P(()=>[...t[6]||(t[6]=[e("i",{class:"fas fa-home mr-2"},null,-1),f(" Dashboard ",-1)])]),_:1})]),t[7]||(t[7]=e("li",null,[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-chevron-right text-gray-400 mr-2"}),e("span",{class:"text-sm font-medium text-gray-500"},"使用者管理")])],-1))])])]),e("div",{class:"flex flex-col sm:flex-row gap-4 mt-4 sm:mt-0"},[e("button",{onClick:A,class:"bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-6 rounded-xl font-semibold hover:from-green-600 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"},[...t[9]||(t[9]=[e("svg",{class:"w-5 h-5 mr-2 inline",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1),f(" 新增使用者 ",-1)])])])]),e("div",te,[e("div",se,[e("div",oe,[g(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>M.value=o),type:"text",placeholder:"搜尋使用者姓名或電子郵件...",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all duration-200",onInput:L},null,544),[[b,M.value]])]),e("button",{onClick:p,disabled:_.value,class:"bg-gradient-to-r from-amber-500 to-orange-600 text-white py-3 px-6 rounded-xl font-semibold hover:from-amber-600 hover:to-orange-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"},[...t[10]||(t[10]=[e("svg",{class:"w-5 h-5 mr-2 inline",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})],-1),f(" 搜尋 ",-1)])],8,le)])]),e("div",ae,[_.value?(r(),a("div",re,[...t[11]||(t[11]=[e("svg",{class:"animate-spin h-8 w-8 text-amber-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("p",{class:"text-gray-600"},"載入中...",-1)])])):i.value.length===0?(r(),a("div",ne,[...t[12]||(t[12]=[e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"})],-1),e("p",{class:"text-gray-600 text-lg"},"沒有找到使用者",-1)])])):(r(),a("div",ie,[e("table",de,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"使用者"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"電子郵件"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"狀態"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"建立時間"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"操作")])],-1)),e("tbody",ue,[i.value?(r(!0),a(D,{key:0},Q(i.value,o=>(r(),a("tr",{key:(o==null?void 0:o.id)||Math.random(),class:"hover:bg-gray-50"},[e("td",ce,[e("div",me,[e("div",fe,[e("div",ve,[e("span",xe,m((o.name||"U").charAt(0).toUpperCase()),1)])]),e("div",pe,[e("div",ge,m(o.name||"未知使用者"),1)])])]),e("td",be,[e("div",ye,m(o.email||"未知郵件"),1)]),e("td",he,[o.email_verified_at?(r(),a("span",we," 已驗證 ")):(r(),a("span",_e," 未驗證 "))]),e("td",ke,m(E(o.created_at)),1),e("td",Ce,[e("div",Me,[e("button",{onClick:S=>j(o),class:"action-btn action-btn--edit",disabled:!(o!=null&&o.id),title:"編輯使用者"},[...t[13]||(t[13]=[e("i",{class:"fas fa-edit action-icon"},null,-1)])],8,ze),e("button",{onClick:S=>q(o),class:"action-btn action-btn--delete",disabled:!(o!=null&&o.id),title:"刪除使用者"},[...t[14]||(t[14]=[e("i",{class:"fas fa-trash action-icon"},null,-1)])],8,Ue)])])]))),128)):y("",!0)])])]))])])])]),v.value?(r(),a("div",Be,[e("div",Ve,[e("div",De,[e("div",Le,[e("h3",Ae,m(d.value?"編輯使用者":"新增使用者"),1),e("button",{onClick:B,class:"text-gray-400 hover:text-gray-600 transition-colors duration-200"},[...t[16]||(t[16]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:R(T,["prevent"]),class:"space-y-4"},[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"姓名",-1)),g(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>n.value.name=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"請輸入姓名"},null,512),[[b,n.value.name]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"電子郵件",-1)),g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>n.value.email=o),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"請輸入電子郵件"},null,512),[[b,n.value.email]])]),e("div",null,[e("label",je,[t[19]||(t[19]=f(" 密碼 ",-1)),d.value?(r(),a("span",Te,"(留空表示不修改)")):y("",!0)]),g(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>n.value.password=o),type:"password",required:!d.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:d.value?"留空表示不修改密碼":"請輸入密碼"},null,8,qe),[[b,n.value.password]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"確認密碼",-1)),g(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>n.value.password_confirmation=o),type:"password",required:!d.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:d.value?"留空表示不修改密碼":"請再次輸入密碼"},null,8,He),[[b,n.value.password_confirmation]])]),l.value?(r(),a("div",Ee,[e("div",Ne,[t[22]||(t[22]=e("svg",{class:"w-5 h-5 text-red-400 mr-3 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),e("div",null,[t[21]||(t[21]=e("p",{class:"text-sm text-red-700 font-medium"},"操作失敗",-1)),e("p",Se,m(l.value),1)])])])):y("",!0),e("div",Fe,[e("button",{type:"button",onClick:B,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors duration-200"}," 取消 "),e("button",{type:"submit",disabled:c.value,class:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200"},[c.value?(r(),a("span",Pe,[...t[23]||(t[23]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),f(" 處理中... ",-1)])])):(r(),a("span",$e,m(d.value?"更新":"建立"),1))],8,Ie)])],32)])])])):y("",!0),k.value?(r(),a("div",Qe,[e("div",Re,[e("div",We,[t[25]||(t[25]=e("div",{class:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 19.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t[26]||(t[26]=e("h3",{class:"text-lg font-semibold text-gray-900 text-center mb-2"},"確認刪除",-1)),e("p",Ge," 您確定要刪除使用者「"+m((V=x.value)==null?void 0:V.name)+"」嗎？此操作無法復原。 ",1),e("div",Je,[e("button",{onClick:t[5]||(t[5]=o=>k.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors duration-200"}," 取消 "),e("button",{onClick:H,disabled:c.value,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[c.value?(r(),a("span",Xe,[...t[24]||(t[24]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),f(" 刪除中... ",-1)])])):(r(),a("span",Oe,"刪除"))],8,Ke)])])])])):y("",!0)],64)}}};export{et as default};
