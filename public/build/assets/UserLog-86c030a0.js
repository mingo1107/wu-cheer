import{s as V,h as z,i as f,j,c as i,a as e,b as B,w as M,k as b,n as A,v as w,F as D,l as P,g as x,t as l,f as T,r as U,o as d}from"./app-c9b46d18.js";class N{async getLogs(_={}){return V.get("/user-logs",_)}}const $=new N,E={class:"container mx-auto px-4 py-8"},F={class:"max-w-7xl mx-auto"},I={class:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white/20"},H={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8"},S={class:"flex","aria-label":"Breadcrumb"},O={class:"inline-flex items-center space-x-1 md:space-x-3"},W={class:"inline-flex items-center"},q={class:"mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"},G={class:"bg-white rounded-xl shadow-lg overflow-hidden"},J={key:0,class:"p-8 text-center"},K={key:1,class:"p-8 text-center"},Q={key:2,class:"overflow-x-auto"},R={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Y={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Z={class:"px-6 py-4 whitespace-nowrap"},ee={class:"text-sm font-medium text-gray-900"},te={class:"text-sm text-gray-500"},se={class:"px-6 py-4 whitespace-nowrap"},ae={class:"text-sm text-gray-900"},oe={class:"text-sm text-gray-500"},re={class:"px-6 py-4 whitespace-nowrap"},le={key:0,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"},ne={key:1,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},de={class:"px-6 py-4 text-sm text-gray-900 max-w-md"},ue=["title"],ce={key:3,class:"bg-gray-50 px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},me={class:"flex-1 flex justify-between sm:hidden"},xe=["disabled"],pe=["disabled"],ge={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},fe={class:"text-sm text-gray-700"},ye={class:"font-medium"},ve={class:"font-medium"},be={class:"font-medium"},_e={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},he=["disabled"],we={class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700"},ke=["disabled"],Le={__name:"UserLog",setup(k){const{success:_,error:h}=z(),y=f(!1),m=f([]),a=f(null),u=f({result:"",date_from:"",date_to:""}),c=async(n=1)=>{var t,g,s;y.value=!0;try{const o={page:n,per_page:15,...u.value};Object.keys(o).forEach(v=>{(o[v]===""||o[v]===null)&&delete o[v]});const r=await $.getLogs(o);r.status?(m.value=Array.isArray((t=r.data)==null?void 0:t.data)?r.data.data:[],a.value={current_page:r.data.current_page||1,last_page:r.data.last_page||1,from:r.data.from||0,to:r.data.to||0,total:r.data.total||0}):(h(r.message||"載入操作記錄失敗"),m.value=[],a.value=null)}catch(o){console.error("載入操作記錄失敗:",o),h("載入操作記錄失敗："+(((s=(g=o.response)==null?void 0:g.data)==null?void 0:s.message)||o.message||"未知錯誤")),m.value=[],a.value=null}finally{y.value=!1}},C=()=>{u.value={result:"",date_from:"",date_to:""},c(1)},p=n=>{n>=1&&n<=a.value.last_page&&c(n)},L=n=>n?new Date(n).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return j(()=>{c()}),(n,t)=>{const g=U("router-link");return d(),i("div",E,[e("div",F,[e("div",I,[e("div",H,[e("div",null,[t[9]||(t[9]=e("h2",{class:"text-2xl font-bold text-gray-800 mb-2"},"使用者操作紀錄",-1)),e("nav",S,[e("ol",O,[e("li",W,[B(g,{to:"/dashboard",class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-amber-600 transition-colors duration-200"},{default:M(()=>[...t[7]||(t[7]=[e("i",{class:"fas fa-home mr-2"},null,-1),x(" Dashboard ",-1)])]),_:1})]),t[8]||(t[8]=e("li",null,[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-chevron-right text-gray-400 mr-2"}),e("span",{class:"text-sm font-medium text-gray-500"},"使用者操作紀錄")])],-1))])])])]),e("div",q,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"結果",-1)),b(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value.result=s),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"},[...t[10]||(t[10]=[e("option",{value:""},"全部",-1),e("option",{value:"1"},"成功",-1),e("option",{value:"0"},"失敗",-1)])],544),[[A,u.value.result]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"開始日期",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.value.date_from=s),type:"date",onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"},null,544),[[w,u.value.date_from]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"結束日期",-1)),b(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>u.value.date_to=s),type:"date",onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"},null,544),[[w,u.value.date_to]])]),e("div",{class:"flex items-end"},[e("button",{onClick:C,class:"w-full bg-gray-500 text-white py-2 px-4 rounded-xl font-semibold hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200"}," 重置篩選 ")])]),e("div",G,[y.value?(d(),i("div",J,[...t[14]||(t[14]=[e("svg",{class:"animate-spin h-8 w-8 text-amber-500 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("p",{class:"text-gray-600"},"載入中...",-1)])])):m.value.length===0?(d(),i("div",K,[...t[15]||(t[15]=[e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1),e("p",{class:"text-gray-600 text-lg"},"沒有找到操作記錄",-1)])])):(d(),i("div",Q,[e("table",R,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"時間"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"使用者"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"控制器/方法"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"結果"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"IP"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"備註")])],-1)),e("tbody",X,[(d(!0),i(D,null,P(m.value,s=>{var o,r;return d(),i("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Y,l(L(s.created_at)),1),e("td",Z,[e("div",ee,l(((o=s.user)==null?void 0:o.name)||"未知使用者"),1),e("div",te,l(((r=s.user)==null?void 0:r.email)||""),1)]),e("td",se,[e("div",ae,l(s.controller||"-"),1),e("div",oe,l(s.method||"-"),1)]),e("td",re,[s.result===1?(d(),i("span",le," 成功 ")):(d(),i("span",ne," 失敗 "))]),e("td",ie,l(s.ip||"-"),1),e("td",de,[e("div",{class:"truncate",title:s.remark},l(s.remark||"-"),9,ue)])])}),128))])])])),a.value&&a.value.total>0?(d(),i("div",ce,[e("div",me,[e("button",{onClick:t[3]||(t[3]=s=>p(a.value.current_page-1)),disabled:a.value.current_page===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 上一頁 ",8,xe),e("button",{onClick:t[4]||(t[4]=s=>p(a.value.current_page+1)),disabled:a.value.current_page===a.value.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 下一頁 ",8,pe)]),e("div",ge,[e("div",null,[e("p",fe,[t[17]||(t[17]=x(" 顯示第 ",-1)),e("span",ye,l(a.value.from||0),1),t[18]||(t[18]=x(" 到 ",-1)),e("span",ve,l(a.value.to||0),1),t[19]||(t[19]=x(" 筆，共 ",-1)),e("span",be,l(a.value.total||0),1),t[20]||(t[20]=x(" 筆記錄 ",-1))])]),e("div",null,[e("nav",_e,[e("button",{onClick:t[5]||(t[5]=s=>p(a.value.current_page-1)),disabled:a.value.current_page===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[21]||(t[21]=[e("span",{class:"sr-only"},"上一頁",-1),e("i",{class:"fas fa-chevron-left"},null,-1)])],8,he),e("span",we," 第 "+l(a.value.current_page)+" / "+l(a.value.last_page)+" 頁 ",1),e("button",{onClick:t[6]||(t[6]=s=>p(a.value.current_page+1)),disabled:a.value.current_page===a.value.last_page,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[22]||(t[22]=[e("span",{class:"sr-only"},"下一頁",-1),e("i",{class:"fas fa-chevron-right"},null,-1)])],8,ke)])])])])):T("",!0)])])])])}}};export{Le as default};
