# 土單資料管理功能說明

## 📋 功能概述

土單資料管理頁面提供完整的土單資料維護功能，採用 Vue3 Excel Editor 進行資料編輯，讓使用者可以像使用 Excel 一樣編輯土單資料。

## 🏗️ 技術實作

### 前端技術
- **Vue 3 Composition API**
- **Vue3 Excel Editor** - 提供 Excel 風格的資料編輯體驗
- **Tailwind CSS** - 響應式 UI 設計
- **Vue Router** - 頁面路由管理

### 頁面結構
參照 `User.vue` 的設計模式，包含：
- 頁面標題和麵包屑導航
- 操作按鈕區域（新增、匯出、返回）
- 搜尋和篩選功能
- Excel 編輯器主區域
- 新增土單 Modal 表單

## 📊 資料欄位定義

### 土單資料結構
```javascript
{
  id: Number,                    // 唯一識別碼
  slip_number: String,           // 土單編號
  case_name: String,             // 案件名稱
  customer_name: String,         // 客戶名稱
  earth_quantity: Number,        // 土方數量
  unit: String,                  // 單位（立方公尺、公噸、車次）
  status: String,                // 狀態（已開立、已核銷、待處理、已回收）
  created_date: String,          // 建立日期
  remarks: String                // 備註
}
```

### Excel 編輯器欄位配置
| 欄位名稱 | 欄位鍵值 | 寬度 | 類型 | 說明 |
|---------|---------|------|------|------|
| 土單編號 | slip_number | 120px | text | 土單的唯一編號 |
| 案件名稱 | case_name | 200px | text | 相關建案或工程名稱 |
| 客戶名稱 | customer_name | 150px | text | 客戶公司名稱 |
| 土方數量 | earth_quantity | 100px | number | 土方數量（數值） |
| 單位 | unit | 100px | text | 計量單位 |
| 狀態 | status | 100px | text | 土單處理狀態 |
| 建立日期 | created_date | 120px | date | 建立日期 |
| 備註 | remarks | 200px | text | 額外說明 |

## 🎯 主要功能

### 1. 資料檢視與編輯
- **Excel 風格編輯**：支援儲存格直接編輯
- **即時更新**：編輯後立即反映在資料中
- **欄位驗證**：根據欄位類型進行資料驗證

### 2. 新增土單
- **Modal 表單**：彈出式表單進行資料輸入
- **欄位驗證**：必填欄位驗證
- **自動狀態設定**：新增的土單自動設定為「已開立」狀態

### 3. 搜尋功能
- **即時搜尋**：支援土單編號、案件名稱、客戶名稱搜尋
- **防抖處理**：500ms 延遲避免過度搜尋

### 4. 資料操作
- **新增行**：在 Excel 編輯器中直接新增資料行
- **刪除行**：刪除不需要的資料行
- **儲存格編輯**：直接編輯儲存格內容

## 🔧 使用方式

### 基本操作
1. **檢視資料**：頁面載入後自動顯示土單資料列表
2. **編輯資料**：點擊儲存格直接編輯內容
3. **新增土單**：點擊「新增土單」按鈕開啟表單
4. **搜尋資料**：在搜尋框輸入關鍵字進行篩選

### Excel 編輯器操作
1. **選取儲存格**：點擊儲存格進行選取
2. **編輯內容**：雙擊儲存格或按 F2 進入編輯模式
3. **新增行**：使用編輯器工具列的新增行功能
4. **刪除行**：選取行後使用刪除功能

## 📝 假資料範例

系統預設包含 5 筆假資料，涵蓋不同狀態和類型的土單：

```javascript
// 範例資料
{
  id: 1,
  slip_number: 'ES-2024-001',
  case_name: '台北市信義區建案A',
  customer_name: '建商A有限公司',
  earth_quantity: 150,
  unit: '立方公尺',
  status: '已開立',
  created_date: '2024-01-15',
  remarks: '一般土方'
}
```

## 🚀 未來擴展

### 待開發功能
1. **資料庫整合**：連接後端 API 進行真實資料操作
2. **Excel 匯入/匯出**：支援 Excel 檔案的上傳和下載
3. **權限控制**：根據使用者角色限制編輯權限
4. **資料驗證**：更嚴格的資料格式和業務規則驗證
5. **批次操作**：支援多筆資料的批次處理

### 技術優化
1. **效能優化**：大量資料的虛擬滾動
2. **離線支援**：PWA 功能支援離線編輯
3. **協作編輯**：多使用者同時編輯的衝突處理

## ✅ 功能狀態

- [x] 頁面基本結構建立
- [x] Vue3 Excel Editor 整合
- [x] 假資料設定
- [x] 新增土單 Modal
- [x] 搜尋功能
- [x] 基本 CRUD 操作
- [x] 響應式設計
- [x] 錯誤處理
- [ ] 資料庫整合（待開發）
- [ ] Excel 匯入/匯出（待開發）
- [ ] 進階驗證（待開發）

## 📱 響應式設計

頁面採用 Tailwind CSS 響應式設計，支援：
- **桌面版**：完整功能展示
- **平板版**：適配中等螢幕尺寸
- **手機版**：簡化操作介面

## 🎨 UI/UX 特色

- **現代化設計**：採用漸層色彩和陰影效果
- **直觀操作**：Excel 風格的熟悉操作體驗
- **即時回饋**：操作後立即顯示結果
- **錯誤提示**：清楚的錯誤訊息和操作指引
