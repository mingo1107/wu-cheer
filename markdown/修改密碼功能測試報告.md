# ä¿®æ”¹å¯†ç¢¼åŠŸèƒ½æ¸¬è©¦å ±å‘Š

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

ä¿®æ”¹å¯†ç¢¼åŠŸèƒ½å…è¨±å·²ç™»å…¥çš„ä½¿ç”¨è€…å®‰å…¨åœ°ä¿®æ”¹å…¶å¯†ç¢¼ã€‚æ­¤åŠŸèƒ½éœ€è¦ä½¿ç”¨è€…æä¾›ç›®å‰å¯†ç¢¼ä»¥é€²è¡Œèº«ä»½é©—è­‰ï¼Œä¸¦è¨­å®šæ–°å¯†ç¢¼ã€‚

## ğŸ—ï¸ æŠ€è¡“å¯¦ä½œ

### åˆ†å±¤æ¶æ§‹
- **Controller**: `AccountController::changePassword()`
- **Service**: `AccountService::changePassword()`
- **Repository**: `UserRepository::updatePassword()`

### API ç«¯é»
```
POST /api/account/change-password
```

### è«‹æ±‚åƒæ•¸
```json
{
    "current_password": "ç›®å‰å¯†ç¢¼",
    "new_password": "æ–°å¯†ç¢¼",
    "new_password_confirmation": "æ–°å¯†ç¢¼ç¢ºèª"
}
```

### å›æ‡‰æ ¼å¼
```json
{
    "status": true,
    "message": "å¯†ç¢¼ä¿®æ”¹æˆåŠŸ",
    "data": {
        "message": "å¯†ç¢¼ä¿®æ”¹æˆåŠŸ"
    }
}
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **èº«ä»½é©—è­‰**: éœ€è¦æœ‰æ•ˆçš„ JWT token
2. **å¯†ç¢¼é©—è­‰**: å¿…é ˆæä¾›æ­£ç¢ºçš„ç›®å‰å¯†ç¢¼
3. **å¯†ç¢¼ç¢ºèª**: æ–°å¯†ç¢¼éœ€è¦ç¢ºèª
4. **å¯†ç¢¼å¼·åº¦**: æœ€å°‘ 6 å€‹å­—å…ƒ
5. **å¯†ç¢¼å”¯ä¸€æ€§**: æ–°å¯†ç¢¼ä¸èƒ½èˆ‡ç›®å‰å¯†ç¢¼ç›¸åŒ
6. **äº¤æ˜“ä¿è­·**: ä½¿ç”¨è³‡æ–™åº«äº¤æ˜“ç¢ºä¿è³‡æ–™ä¸€è‡´æ€§

## ğŸ§ª æ¸¬è©¦æ¡ˆä¾‹

### æ¸¬è©¦ 1: æˆåŠŸä¿®æ”¹å¯†ç¢¼
```bash
# 1. å…ˆç™»å…¥å–å¾— token
curl -X POST http://localhost:8000/api/account/login \
  -H 'Content-Type: application/json' \
  -d '{"email": "test@example.com", "password": "password123"}'

# 2. ä½¿ç”¨ token ä¿®æ”¹å¯†ç¢¼
curl -X POST http://localhost:8000/api/account/change-password \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_JWT_TOKEN' \
  -d '{
    "current_password": "password123",
    "new_password": "newpassword456",
    "new_password_confirmation": "newpassword456"
  }'
```

### æ¸¬è©¦ 2: ç›®å‰å¯†ç¢¼éŒ¯èª¤
```bash
curl -X POST http://localhost:8000/api/account/change-password \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_JWT_TOKEN' \
  -d '{
    "current_password": "wrongpassword",
    "new_password": "newpassword456",
    "new_password_confirmation": "newpassword456"
  }'
```

### æ¸¬è©¦ 3: æ–°å¯†ç¢¼ç¢ºèªä¸ä¸€è‡´
```bash
curl -X POST http://localhost:8000/api/account/change-password \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_JWT_TOKEN' \
  -d '{
    "current_password": "password123",
    "new_password": "newpassword456",
    "new_password_confirmation": "differentpassword"
  }'
```

### æ¸¬è©¦ 4: æ–°å¯†ç¢¼èˆ‡ç›®å‰å¯†ç¢¼ç›¸åŒ
```bash
curl -X POST http://localhost:8000/api/account/change-password \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_JWT_TOKEN' \
  -d '{
    "current_password": "password123",
    "new_password": "password123",
    "new_password_confirmation": "password123"
  }'
```

### æ¸¬è©¦ 5: æœªç™»å…¥ç‹€æ…‹
```bash
curl -X POST http://localhost:8000/api/account/change-password \
  -H 'Content-Type: application/json' \
  -d '{
    "current_password": "password123",
    "new_password": "newpassword456",
    "new_password_confirmation": "newpassword456"
  }'
```

## ğŸ“Š é æœŸçµæœ

| æ¸¬è©¦æ¡ˆä¾‹ | é æœŸç‹€æ…‹ç¢¼ | é æœŸå›æ‡‰ |
|---------|-----------|---------|
| æˆåŠŸä¿®æ”¹å¯†ç¢¼ | 200 | `{"status": true, "message": "å¯†ç¢¼ä¿®æ”¹æˆåŠŸ"}` |
| ç›®å‰å¯†ç¢¼éŒ¯èª¤ | 200 | `{"status": false, "message": "ç›®å‰å¯†ç¢¼éŒ¯èª¤"}` |
| å¯†ç¢¼ç¢ºèªä¸ä¸€è‡´ | 422 | `{"status": false, "message": "é©—è­‰å¤±æ•—", "errors": {...}}` |
| æ–°å¯†ç¢¼èˆ‡ç›®å‰å¯†ç¢¼ç›¸åŒ | 200 | `{"status": false, "message": "æ–°å¯†ç¢¼ä¸èƒ½èˆ‡ç›®å‰å¯†ç¢¼ç›¸åŒ"}` |
| æœªç™»å…¥ç‹€æ…‹ | 401 | `{"message": "Unauthenticated."}` |

## ğŸ”§ éƒ¨ç½²æŒ‡ä»¤

### 1. é€²å…¥å®¹å™¨
```bash
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer"
```

### 2. æ¸…é™¤å¿«å–
```bash
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan config:clear"
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan route:clear"
```

### 3. æŸ¥çœ‹è·¯ç”±
```bash
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan route:list | grep change-password"
```

## ğŸ“ æ³¨æ„äº‹é …

1. ä¿®æ”¹å¯†ç¢¼å¾Œï¼Œä½¿ç”¨è€…éœ€è¦é‡æ–°ç™»å…¥
2. æ‰€æœ‰å¯†ç¢¼æ“ä½œéƒ½æœƒè¨˜éŒ„åœ¨æ—¥èªŒä¸­
3. å¯†ç¢¼ä½¿ç”¨ bcrypt é€²è¡ŒåŠ å¯†å„²å­˜
4. å»ºè­°å®šæœŸæ›´æ›å¯†ç¢¼ä»¥ç¶­è­·å®‰å…¨æ€§

## âœ… åŠŸèƒ½ç‹€æ…‹

- [x] Controller å±¤å¯¦ä½œ
- [x] Service å±¤å¯¦ä½œ
- [x] Repository å±¤å¯¦ä½œ
- [x] è·¯ç”±è¨­å®š
- [x] åƒæ•¸é©—è­‰
- [x] éŒ¯èª¤è™•ç†
- [x] æ—¥èªŒè¨˜éŒ„
- [x] å®‰å…¨æª¢æŸ¥
- [x] æ¸¬è©¦æ¡ˆä¾‹
