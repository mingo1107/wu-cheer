# Laravel 專案分層架構說明

本專案採用以下分層設計模式：
Controller → Service → Repository → Model

- Controller：取得與驗證請求參數、呼叫 Service、包裝統一回應格式、處理例外、記錄操作日誌
- Service：編排商業邏輯流程、整備參數、掌管交易邊界（DB Transaction）
- Repository：封裝資料庫查詢與交易、維持資料存取的一致抽象
- 禁止事項：嚴禁在 Controller／Service 直接進行資料庫查詢與交易

請務必遵循以上開發方式，以提高可維護性與可擴充性。

---

## 📁 資料夾結構

```
app/
├── Http/
│   └── Controllers/
│       └── AccountController.php
├── Services/
│   └── UserService.php
├── Repositories/
│   └── UserRepository.php
├── Models/
│   └── User.php
```

---

## 🛣️ 路由命名規則

### 命名格式
```
{第一層}.{第二層}.{第三層}.{第四層}
```

### 各層說明
| 層級 | 說明 | 範例 |
|------|------|------|
| **第一層** | 類型識別 | `web` (網頁)、`api` (API) |
| **第二層** | 網址路徑 | `report-customer` |
| **第三層** | 權限代號 | `api-index`、`api-list`、`api-export` |
| **第四層** | 方法名稱 | `index`、`show`、`store`、`update`、`delete` |

---

## 🐳 Laradocker 容器執行方式

### 容器資訊
- **容器名稱**: `laradock-workspace-1`
- **專案路徑**: `/var/www/case/01_mingo/wu-cheer`
- **PHP 版本**: 8.4
- **Laravel 版本**: 12.x

### 常用指令

#### 1. 進入容器執行指令
```bash
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && [指令]"
```

#### 2. 常用 Laravel 指令
```bash
# 查看路由
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan route:list"

# 資料庫遷移
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan migrate"

# 建立測試資料
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan db:seed --class=TestUserSeeder"

# 啟動開發伺服器
docker exec laradock-workspace-1 bash -c "cd /var/www/case/01_mingo/wu-cheer && php artisan serve --host=0.0.0.0 --port=8000"
```

#### 3. API 測試指令
```bash
# 登入測試
curl -X POST http://wu-cheer.local.com/api/account/login -H 'Content-Type: application/json' -d '{"email": "test@example.com", "password": "password123"}'

# 登出測試
curl -X POST http://wu-cheer.local.com/api/account/logout -H 'Content-Type: application/json' -H 'Authorization: Bearer YOUR_JWT_TOKEN'

# 取得帳戶資訊測試
curl -X GET http://wu-cheer.local.com/api/account/me -H 'Content-Type: application/json' -H 'Authorization: Bearer YOUR_JWT_TOKEN'

# 修改密碼測試
curl -X POST http://wu-cheer.local.com/api/account/change-password -H 'Content-Type: application/json' -H 'Authorization: Bearer YOUR_JWT_TOKEN' -d '{"current_password": "password123", "new_password": "newpassword456", "new_password_confirmation": "newpassword456"}'
```

### 容器狀態檢查
```bash
# 查看運行中的容器
docker ps

# 查看容器端口映射
docker port laradock-nginx-1
docker port laradock-workspace-1
```

### 注意事項
- 專案檔案位於宿主機的 `/Users/mingotsai/Work/projects/case/01_mingo/wu-cheer`
- 容器內專案路徑為 `/var/www/case/01_mingo/wu-cheer`
- 使用 `laradock-workspace-1` 容器執行所有 Laravel 指令
- 開發伺服器預設運行在 `http://localhost:8000`
